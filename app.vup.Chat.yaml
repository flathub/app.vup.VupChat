app-id: app.vup.Chat
runtime: org.freedesktop.Platform
runtime-version: "23.08"
sdk: org.freedesktop.Sdk
command: vup_chat
finish-args:
  - "--share=ipc"
  - "--socket=fallback-x11"
  - "--socket=wayland"
  - "--device=dri"
  - "--socket=pulseaudio"
  - "--share=network"
  - "--talk-name=org.kde.StatusNotifierWatcher"
modules:
  - shared-modules/libsecret/libsecret.json
  - name: libnotify
    buildsystem: meson
    config-opts:
      - -Dman=false
      - -Dgtk_doc=false
      - -Ddocbook_docs=disabled
    cleanup:
      - /include
      - /lib/pkgconfig
      - /lib/debug
      - /lib/girepository-1.0
      - /share/gtk-doc
      - /share/gir-1.0
    sources:
      - type: git
        url: https://gitlab.gnome.org/GNOME/libnotify.git
        tag: 0.8.3

  - name: vup-chat
    buildsystem: simple
    build-commands:
      - install -d /app/vup-chat
      - cp -r build/* /app/vup-chat
      - chmod +x /app/vup-chat/vup_chat
      - mkdir -p /app/bin
      - ln -s /app/vup-chat/vup_chat /app/bin/vup_chat
      - install -Dm644 icon.svg /app/share/icons/hicolor/$size/apps/app.vup.Chat.png
      - install -Dm644 icon.svg /app/share/icons/hicolor/scalable/apps/app.vup.Chat.svg
      - install -Dm644 app.vup.Chat.desktop -t /app/share/applications/
      - install -Dm644 app.vup.Chat.metainfo.xml -t /app/share/metainfo/
    sources:
      - type: file
        url: https://raw.githubusercontent.com/vup-app/vup-chat/v0.5.10/static/icon.svg
        sha256: b80bbe5893595b1f47497de3400472492878550ac3abc504c40dd24468ae9c3d
      - type: file
        url: https://raw.githubusercontent.com/vup-app/vup-chat/v0.5.11/linux/metadata/app.vup.Chat.metainfo.xml
        sha256: b85e9c3046b64996d675f37483abb4f6de1382e5c64eb2e7fe14f8086cb2f932
      - type: file
        url: https://raw.githubusercontent.com/vup-app/vup-chat/v0.5.10/linux/metadata/app.vup.Chat.desktop
        sha256: f3a6948a1cf3b29a632c6d0ef00fa37125b6a0f574bff62869d67e4c4e530863
      - type: archive
        dest: build
        only-arches:
          - x86_64
        url: https://github.com/vup-app/vup-chat/releases/download/v0.5.8/vup-chat-linux.zip
        sha256: 8581bbc9fc7dde7f44ee4926d9aedf10db007a96d8f230889070bbb02e60f1bf
