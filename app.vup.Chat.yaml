app-id: app.vup.VupChat
runtime: org.freedesktop.Platform
runtime-version: "23.08"
sdk: org.freedesktop.Sdk
command: vup_chat
finish-args:
  - "--share=ipc"
  - "--socket=fallback-x11"
  - "--socket=wayland"
  - "--device=dri"
  - "--socket=pulseaudio"
  - "--share=network"
  - "--talk-name=org.kde.StatusNotifierWatcher"
modules:
  - shared-modules/libsecret/libsecret.json
  - name: libnotify
    buildsystem: meson
    config-opts:
      - -Dman=false
      - -Dgtk_doc=false
      - -Ddocbook_docs=disabled
    cleanup:
      - /include
      - /lib/pkgconfig
      - /lib/debug
      - /lib/girepository-1.0
      - /share/gtk-doc
      - /share/gir-1.0
    sources:
      - type: git
        url: https://gitlab.gnome.org/GNOME/libnotify.git
        tag: 0.8.3

  - name: vup-chat
    buildsystem: simple
    build-commands:
      - install -d /app/vup-chat
      - cp -r build/* /app/vup-chat
      - chmod +x /app/vup-chat/vup_chat
      - mkdir -p /app/bin
      - ln -s /app/vup-chat/vup_chat /app/bin/vup_chat
      - install -Dm644 icon.svg /app/share/icons/hicolor/$size/apps/app.vup.VupChat.png
      - install -Dm644 icon.svg /app/share/icons/hicolor/scalable/apps/app.vup.VupChat.svg
      - install -Dm644 app.vup.VupChat.desktop -t /app/share/applications/
      - install -Dm644 app.vup.VupChat.metainfo.xml -t /app/share/metainfo/
    sources:
      - type: file
        url: https://raw.githubusercontent.com/vup-app/vup-chat/v0.5.12/static/icon.svg
        sha256: b80bbe5893595b1f47497de3400472492878550ac3abc504c40dd24468ae9c3d
      - type: file
        url: https://raw.githubusercontent.com/vup-app/vup-chat/v0.5.12/linux/metadata/app.vup.VupChat.metainfo.xml
        sha256: dbfd1a1eb4a6b736226ea19537684691a6a8d843ec1a8ccd92058021e9b9156d
      - type: file
        url: https://raw.githubusercontent.com/vup-app/vup-chat/v0.5.12/linux/metadata/app.vup.VupChat.desktop
        sha256: cdeabd8c448a487b0153b413caecac78917114f25f9d2d3a996b43007a854caf
      - type: archive
        dest: build
        only-arches:
          - x86_64
        url: https://github.com/vup-app/vup-chat/releases/download/v0.5.8/vup-chat-linux.zip
        sha256: 8581bbc9fc7dde7f44ee4926d9aedf10db007a96d8f230889070bbb02e60f1bf
